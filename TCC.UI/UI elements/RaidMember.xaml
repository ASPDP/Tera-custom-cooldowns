<UserControl x:Class="TCC.UI_elements.RaidMember"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:TCC.UI_elements"
             xmlns:converters="clr-namespace:TCC.Converters"
             mc:Ignorable="d" 
             Loaded="UserControl_Loaded"
             Unloaded="UserControl_Unloaded"
             >
    <UserControl.Resources>
        <converters:ClassImageConverter x:Key="classToImageConv"/>
        <converters:LaurelImageConverter x:Key="laurelToImageConv"/>
        <converters:ClassToFillConverter x:Key="classToFillConv"/>

    </UserControl.Resources>
    <Grid Height="Auto" Margin="0" Width="102" ToolTip="{Binding Name}">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="Auto"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        <Grid.Style>
            <Style>
                <Style.Triggers>
                    <DataTrigger Binding="{Binding Online}" Value="False">
                        <DataTrigger.EnterActions>
                            <BeginStoryboard>
                                <Storyboard>
                                    <DoubleAnimation From="1" To=".5"
                                     Duration="0:0:0.2"
                                     Storyboard.TargetProperty="Opacity"/>
                                </Storyboard>
                            </BeginStoryboard>
                        </DataTrigger.EnterActions>
                    </DataTrigger>
                    <DataTrigger Binding="{Binding Online}" Value="True">
                        <DataTrigger.EnterActions>
                            <BeginStoryboard>
                                <Storyboard>
                                    <DoubleAnimation From=".5" To="1"
                                     Duration="0:0:0.2"
                                     Storyboard.TargetProperty="Opacity"/>
                                </Storyboard>
                            </BeginStoryboard>
                        </DataTrigger.EnterActions>
                    </DataTrigger>
                </Style.Triggers>
            </Style>
        </Grid.Style>

        <Border Style="{StaticResource border}" Grid.ColumnSpan="2" Margin="4,4"/>
        <Rectangle HorizontalAlignment="Right" Fill="{Binding UserClass, Converter={StaticResource classToFillConv}}" Width="3" Margin="5,5" Grid.ColumnSpan="2"/>
        <Grid Margin="-1,-2,-3,0" Width="32" Height="32">
            <Image Source="{Binding UserClass, Converter={StaticResource classToImageConv}}" Opacity="1"
                           Margin="1,2,0,0" RenderOptions.BitmapScalingMode="Fant" UseLayoutRounding="True" HorizontalAlignment="Center" VerticalAlignment="Center"
                           Width="22">
                <Image.Effect>
                    <DropShadowEffect Color="#ff20f0ff" BlurRadius="3" ShadowDepth="0"/>
                </Image.Effect>
                <Image.CacheMode>
                    <BitmapCache RenderAtScale="2"/>
                </Image.CacheMode>
            </Image>
        </Grid>
        <Grid Grid.Column="1" VerticalAlignment="Center" HorizontalAlignment="Stretch" Margin="0,0,0,3">
            <Grid.RowDefinitions>
                <RowDefinition/>
                <RowDefinition />
                <RowDefinition />
            </Grid.RowDefinitions>
            <TextBlock Text="{Binding Name}" Foreground="White" VerticalAlignment="Center" Margin="0,0,0,0" HorizontalAlignment="Left" FontSize="11" Grid.Row="0" TextTrimming="CharacterEllipsis" Width="65"/>
            <Rectangle Fill="#ef536d" Height="2" Width="64" Grid.Row="1" HorizontalAlignment="Left" Margin="0,1" >
                <Rectangle.LayoutTransform>
                    <ScaleTransform ScaleX="{Binding HpFactor}"/>
                </Rectangle.LayoutTransform>
            </Rectangle>
            
            <Border Height="2" Width="32" BorderBrush="#202020" BorderThickness="0,0,1,0" Grid.Row="1" HorizontalAlignment="Left" Margin="0,1"/>
            <Rectangle Fill="#66c6ff" Height="2" Width="64" Grid.Row="2" HorizontalAlignment="Left" >
                <Rectangle.LayoutTransform>
                    <ScaleTransform ScaleX="{Binding MpFactor}"/>
                </Rectangle.LayoutTransform>
            </Rectangle>

        </Grid>
    </Grid>

</UserControl>
